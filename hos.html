  
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="plebskylook.css">
    <title>Magické příkazy pana Černého</title>
</head>
<body>
  <h1>LINUX</h1>
  <h2>Příkazy</h2>
  <p><i>Tyto příkazy platí pro Ubuntu a asi Debian. No Gentoo here.</i></p>
  <br>
  <h3>Práce se systémem</h3>
  <p>cd [název složky] - přesune uživatele do určité složky</p>
  <p>cd .. - přesune uživatele o složku zpět</p>
  <p>dir - zobrazí složky</p>
  <p>(sudo) nano [jméno souboru.přípona] - otevře textový editor</p>
  <p>(sudo) vim [jméno souboru.přípona] - otevře jiný textový editor]</p>
  <p>(sudo) mkdir [název] - vytvoří složku</p>
  <p>(sudo) touch [název(.přípona)] - vytvoří složku</p>
  <p>(sudo) rmdir [název] - smaže složku</p>
  <p>(sudo) rm [název(.přípona)] - smaže soubor</p>
  <p>(sudo) mv [adresa souboru/složky] [cílová adresa] - přesune soubor</p>
  <p>cp [adresa souboru/složky] [cílová složka] - zkopíruje složku</p>
  
  <br>
  
  <h3>Práce se softwarem</h3>
  <p>sudo apt install [jméno programu] - instaluje program</p>
  <p>sudo apt remove [jméno programu] - maže program</p>
  <p>apt search [jméno programu] - hledá programy v repozitáři</p>
  <br>
  <p>Lze aplikovat i na několik programů najednou:</p>
  <p>sudo apt install [jméno 1] [jméno 2] [jméno 3]</p>
  <br>
  <h3>Užitečné programy</h3>
  <p>Midnight Commander - terminálový grafický prohlíeč souborů a složek</p>
  <p><i>sudo apt install mc</i></p>
  <p>Apache server</p>
  <p><i>sudo apt install apache2</i></p>
  <p>PHP</p>
  <p><i>sudo apt install php libapache2-mod-php</i></p>
  <p>Python</p>
  <p><i>sudo apt install python2</i></p>
  <p><i>sudo apt install python3</i></p>
  <p>Htop (terminálový správce úloh)</p>
  <p><i>sudo apt install htop</i></p>
  
  <h2>Užitečné cesty k souboru</h2>
  
  <p><i>sudo nano /etc/netplan/01-netcfg.yaml</i> - Zde lze nastavit IP adresy etc.</p>
  <h4>Ukázka syntaxe:</h4>
  <i><p>network:</p>
  <p>version: 2</p>
  <p>renderer: networkd</p>
  <p>ethernets:</p>
  <p> ens3:</p>
  <p>  dhcp4: no</p>
  <p>    addresses:</p>
  <p>      - 192.168.121.221/24<p>
  <p>    gateway4: 192.168.121.1</p>
  <p>    nameservers:</p>
  <p>        addresses: [8.8.8.8, 1.1.1.1]</p></i>
  
  <p><b>Poznámka:</b> Toto se nekopíruje, je to citlivé na pozice jednotlivých charakterů. Prostě to přepišt!<p>
  <p><b>Poznámka 2:</b> Tento plán nemusí fungovat na 100%, je to hodně individuální.</p>
  <p><b>Poznámka 3:</b> Pokud je editace souboru hotová, je potřeba spustit tento příkaz: <i>sudo netplan apply</i></p>
  <br>
  
  <p><i>/home/</i> - Zde se nachází uživatelské účty (výjma root uživatele, ale se na Ubuntu řešit moc nemusí)</p> 
  <br>
  
  <p><i>/var/www/</i> - Zde se nachází webové stránky, na které Apache server vidí</p>
  <br>
  
  <h2>Nastavení Apache serveru</h2>
  <p>Po instalaci a spuštění Apache se může stát, že se úplně nebudou mít rádi s firewallem</p>
  <p>Pro vyřešení tohoto problému je potřeba zadat několik příkazů</p>
  <p>1. <i>sudo ufw app list</i> - Vypíše seznat dostupných programů, které komunikují s firewallem</p>
  <p>V nabídce by se mělo nacházet <i>Apache</i>, <i>Apache Full</i> a <i>Apache Secure</i></p>
  <p>2. <i>sudo ufw allow 'Apache Full'</i> - Povolí Apache server na všechny porty</p>
  <p>3. PROFIT</p>
  <br>
  <p>Pokud to nebude fungovat, zkusil bych restartovat Apache příkazem <i>sudo systemctl reload apache2</i> nebo <i>sudo systemctl reload apache2</i></p>
  
  <h2>Práva souborů</h2>
  <p>Uživatelé mohou mít nastavené různé práva přístupu k jednotlivým souborům, například se může jednat o jejich spustitelnost</p>
  <p>Tyto práva se dají řešit přes příkazy, ale jednodušší je je řešit v Midnight Commanderu</p>
  <p>1. Zapněte Midnight Commander -> <i>(sudo) mc</i></p>
  <p>2. Najeďte do adresáře kde se nachází vybraný soubor a klikněte na něj</p>
  <p>3. Najeďte v menu na <i>File</i> a v něm na <i>chmod</i></p>
  <p>4. Změňte práva vlastníka a potvrďte</p>
  <p>PROFIT</p>
  
  <h2>Spuštění skriptu přes terminál</h2>
  <p>Je potřeba změnit práva tak, aby byl soubor uživatelem spustitelný</p>
  <p>Taktéž se nacházet v adresáři, ve kterém se skript nachází<p>
  <p>Běžně se skript spouští tímto příkazem: <i>./[jméno skriptu]</i></p>
  <p>Pokud ho chete spouštět v pozadí, napište za příkaz <i>&</i></p>
  <p><b>Poznámka:</b> Syntaxe příkazů se může lišit v závislosti na jazyku, tento postup jednoznačně funguje u bash souborů</p>
  <h3>Vypnutí skriptu</h3>
  <p>Pokud běží skript v popředí, stačí stisknout klávesovou zkratku ctrl+c</p>
  <p>Pokud běží v pozadí, je potřeba ho vypnout příkazem <i>kill</i>, vypnout přes program Htop nebo restartovat pořítač</p>
  
  <h1>Windows</h1>
  <p>Nevím, všechno se dělá přes ten jejich Server Manager, takže tady jsou nějaké základní tutoriály.</p>
  <h2><a href="https://www.server-world.info/en/note?os=Windows_Server_2019&p=initial_conf&f=4">Statická IP</a></h2>
  <h2><a href="https://www.server-world.info/en/note?os=Windows_Server_2016&p=initial_conf&f=1">Managment uživatelů</a></h2>
  <h2><a href="https://msftwebcast.com/2019/06/enable-roaming-profiles-on-windows-server-2019.html">Roaming Users</a></h2>
  
  <h1>Raspberry Pi</h1>
  <p>Je to jako Linux, ale jsou tam Piny</p>
  <h3>Piny pro Raspberry Pi 3</h3>
  <img src="opraski/Raspberry-Pi-3-B-Pinout-in-detail.jpg" width="600px">
  
  <h1>ESP</h1>
  <h2>Wi-Fi serióvá linka</h2>
  <p>#include <ESP8266WiFi.h></p>
  <p>const char* ssid = "Tvé SSID";</p>
  <p>const char* password="Tvé heslo k WiFi";</p>
  <p>void setup() {</p>
  <p>// put your setup code here, to run once:</p>
  <p>Serial.begin(9600);</p>
  <p>delay(1000);</p>
  <p>Serial.println("Program 03Wifi_SeriovaLinka");</p>
  <p>WiFi.begin(ssid, password);</p>
  <p>Serial.print("Pripojuji se k "); Serial.print(ssid);</p>
  <p>while (WiFi.status() != WL_CONNECTED) {</p>
  <p>delay(1000);</p>
  <p>Serial.print(".");</p>
  <p>}</p>
  <p>Serial.println("\n");</p>
  <p>Serial.print("IP adresa: "); Serial.println(WiFi.localIP());</p>
  <p>Serial.print("MAC adresa: "); Serial.println(WiFi.macAddress());</p>
  <p>}</p>
    <p>void loop() {</p>
  <p>// put your main code here, to run repeatedly:</p>
    <p>}</p>
  
<h2>Ovládání LED</h2>
  <p>  // Tento kod vyuziva zdrojove kody z odkazu:</p>
<p>// https://randomnerdtutorials.com/esp8266-web-server-with-arduino-ide/</p>
<p>// I. Globalni sekce</p>
<p>// Knihovna pro komunikaci s ESP8266 WiFi + obsahuje tcp server viz. class WiFiServer</p> 
<p>#include <ESP8266WiFi.h></p>
<p>// Udaje k WiFi</p>
<p>const char* ssid = "Baron_Sitko24";</p>
<p>const char* password = "Alfini_283";</p>
<p>// Vytvoreni objektu tcp server, ktery nasloucha na portu 80</p>
<p>WiFiServer server(80);</p>
<p>// Retezce pro www stranku s formularem</p>
<p>String header = " H T T P / 1.1 200 OK \ r \ nContent-Type: text/html\r\n\r\n";</p>
<p>String html_1 = "< !DOCTYPE html><html><head>< t i t l e >Za< / t i t l e ></head><body>< d i v id='main' > " ;</p>
<p>String html_2 = "< p style=\"text-align: center\"> < h 2 >Priklad ovladani spotrebice.< / h 2 > < / p >";</p>
<p>String html_6 = "< h 3 >Ovladani zarovky< / h 3>";</p>
<p>String html_7 = "< f o r m id='F1' action='ZAROVKAON'>< inp u t class='button' type='submit' value='Zapni zarovku' >< / f o r m >< b r >";</p>
<p>String html_8 = "< f o r m id='F2' action='ZAROVKAOFF'>< inp u t class='button' type='submit' value='Vypni zarovku' >< / f o r m >< b r >";</p>
<p>String html_9 = "< /div></body></html>";</p>
<p>// promenna pro cteni pozadavku na web server</p>
<p>String request = "";</p>
<p>// Zarovka je pripojena ke GPIO 13</p>
<p>int Pin_zarovky = 13;</p>
<p>// II. Setup sekce</p>
<p>void setup() {</p>
<p>  // Inicializace serioveho portu - prenosova rychlost 115200 b/s</p>
<p>  Serial.begin(9600);</p>
<p>  delay(10);</p>
<p>  // Pin_zarovky nastavime jako vystupni </p>
<p>  pinMode(Pin_zarovky, OUTPUT); </p>
<p>  digitalWrite(Pin_zarovky, 0);   // </p>
<p>  delay(2000);               // cekej </p>
<p>  digitalWrite(Pin_zarovky, 1);    //  </p>
<p>// Pripojeni k WiFi siti a zobrazeni stavu WiFi v seriovem monitoru</p>
<p>  Serial.println();</p>
<p>  Serial.print("Connecting to ");</p>
<p>  Serial.println(ssid);</p>
<p>  WiFi.begin(ssid, password);</p>
<p>  while (WiFi.status() != WL_CONNECTED) {</p>
<p>    delay(500);</p>
<p>    Serial.print(".");</p>
<p>  }</p>
<p>  Serial.println("");</p>
<p>  Serial.println("WiFi je pripojena");</p>
<p>  // Spusteni tcp serveru</p>
<p>  server.begin();</p>
<p>  delay(5000);</p>
<p>  Serial.println("Web server je spusten. Cekej nez ESP ziska IP adresu");</p>
<p>  // Vypise IP addresu a MAC adresu</p>
<p>  Serial.print("IP address:\t"); Serial.println(WiFi.localIP());</p>
<p>  Serial.print("MAC adresa:\t"); Serial.println(WiFi.macAddress());</p>
<p>}</p>
<p>// III. Sekce nekonecne smycky</p>
<p>void loop() {</p>
<p>  // Server nasloucha az se k nemu prihlasi nejaky klient. Typicky je to webovy browser</p>
<p>  WiFiClient client = server.available();</p>
<p>  if (!client)  {  return;  }</p>
<p>  // Cte prvni radek pozadavku (request)</p>
<p>  request = client.readStringUntil('\r');</p>
<p>  // </p>
<p>  Serial.println(request);       </p>
<p>  // pokud se vrati  </p>
<p>  if       ( request.indexOf("ZAROVKAON") > 0 )  { digitalWrite(Pin_zarovky, 1); }</p>
<p>  else if  ( request.indexOf("ZAROVKAOFF") > 0 ) { digitalWrite(Pin_zarovky, 0); }</p>
<p>  client.flush();</p>
<p>  client.print( header );</p>
<p>  client.print( html_1 );</p>
<p>  client.print( html_2 );</p>
<p>  client.print( html_6 );</p>
<p>  client.print( html_7 );</p>
<p>  client.print( html_8 );</p>
<p>  client.print( html_9 );</p>
<p>  delay(5);</p>
<p>// client.stop();</p>
<p>// Serial.println("Client disconnected.");</p>
<p>}</p>
  
<h2>BLIK</h2>
<p>int pin=13; </p>
<p>void setup() { </p>
<p>  // Sem vložte programový kód, který se má provést pouze jednou </p>
<p>  // nastavíme pin GPIO 13 (D7) jako výstupní. </p>
<p>  pinMode(pin, OUTPUT); </p>
<p>}  </p>
<p>void loop() { </p>
<p>  // loop – sem vložíme kód, který se ve smyčce neustále opakuje </p>
<p>  digitalWrite(pin, HIGH);   // rozsvit LED (HIGH na pinu bude Ucc) </p>
<p>  delay(1500);               // wait for a milisecond </p>
<p>  digitalWrite(pin, LOW);    // zhasni LED (LOW na pinu bude 0V) </p>
<p>  delay(1000);               // wait for a milisecond </p>
<p>}</p>

<h2>BLIK2</h2>
<p><b>Zapisuje se to do seriálového monitoru ON/OFF</b></p>
<br>
<p>int pin=13;</p>
<p>void setup() {</p>
<p>  // Sem vložte programový kód, který se má provést pouze jednou </p>
<p>  // nastavíme pin GPIO 13 (D7) jako výstupní. </p>
<p>  pinMode(pin, OUTPUT); </p>
<p>  // Inicializace seriove linky</p>
<p>  Serial.begin(9600);</p>
<p>  delay(2000);</p>
<p>  Serial.println("Program Blik02");</p>
<p>}  </p>
<p>void loop() {</p> 
<p>  // loop – sem vložíme kód, který se ve smyčce neustále opakuje </p>
<p>  digitalWrite(pin, HIGH);   // rozsvit LED (HIGH na pinu bude Ucc) </p>
<p>  Serial.println("LED ON");</p>
<p>  delay(1500);               // cekej 500 ms </p>
<p>  digitalWrite(pin, LOW);    // zhasni LED (LOW na pinu bude 0V) </p>
<p>  Serial.println("LED OFF");</p>
<p>  delay(1000);               // cekej 500 ms </p>
<p>}</p>

<img src="opraski/blik.png" width="600px">
<p><i>Platí pro BLIK i BLIK2</i></p>

<h3>OneWire</h3>
<p>int pin=13; </p>
<p>void setup() { </p>
<p>  // Sem vložte programový kód, který se má provést pouze jednou </p>
<p>  // nastavíme pin GPIO 13 (D7) jako výstupní.</p> 
<p>  pinMode(pin, OUTPUT); </p>
<p>  // Inicializace seriove linky</p>
<p>  Serial.begin(9600);</p>
<p>  delay(2000);</p>
<p>  Serial.println("Program Blik02");</p>
<p>}  </p>
<p>void loop() { </p>
<p>  // loop – sem vložíme kód, který se ve smyčce neustále opakuje </p>
<p>  digitalWrite(pin, HIGH);   // rozsvit LED (HIGH na pinu bude Ucc)</p> 
<p>  Serial.println("LED ON");</p>
<p>  delay(1500);               // cekej 500 ms </p>
<p>  digitalWrite(pin, LOW);    // zhasni LED (LOW na pinu bude 0V)</p> 
<p>  Serial.println("LED OFF");</p>
<p>  delay(1000);               // cekej 500 ms </p>
<p>}</p>

<h4>ESP Easy Flasher</h4>
<p><b>Odkaz na stažení:</b> https://github.com/letscontrolit/ESPEasy/releases/tag/mega-20200608</p>
<img src="opraski/esp_postup.png">
<br>
<p>Připojíme na náš COM</p>
<p>Firmware bude: ESP_Easy_mega_20200608_normal_ESP8266_4M1M.bin</p>
<p>Dále klikneme na flash ESP počkáme nějakou dobu a připojíme se na WiFi ESP_Easy</p>
<p>Do prohlížeče vypíšeme IP adresu kterou nám to dá</p>
<img src="opraski/esp_program.png" width="600px">
<p>Následně klikneme na Tools, Advanced a do NTP zadáme: ntp.cesnet.cz</p>

<h4>Připojení LCD a tepelného/tlakového čidla</h4>
<img src="opraski/teplomer_zapojeni.png" width="600px">
<p>D2=SDA</p>
<p>D1=SCL</p>
<p>Opět se připojíme na svou IP adresu skrze ESP Easy Flasher</p>
<p>Klikneme na Hardware a tam zkontrolujeme zda jsme SDA/SCL připojili správně</p>
<p>Klikneme na Tools a vybereme I2C Scan:	0x27 = LCD, MCP, PCF</p>
<p>						0x76 = BME, BMP, MS, HT</p>
<p>Dále klikneme na Divices a ADD new device a zvolíme Environment- BMx280 pojmenujeme BMP odfajfkujeme Enabled, I2C address by mělo být 0x76, interval = 5sec., a klikneme submit</p>
<p>Dále opět přidáme zařízení , ale tentokrát Display – LCD2004, pojmenujeme LCD fajfka Enabled, I2C address 0x27, display site 2x16, </p>
<p>Line 1: t=[BMP#Temperature]{D}C	toto je pro teplotu</p>
<p>Line 2: p=[BMP#Pressure] hPA	toto je pro tlakoměr, interval buse opět 5 sekund</p>
  
<h1>Obecná část</h1>
<p>Sběrnice One Wire-----------------------------------------------------------------------------------------------------------</p>
<br>
<p>Kolik vodičů je potřeba pro přenos dat po sběrnici One Wire a které to jsou? Jak se označuje?</p>
<p>jeden datový + napájení, pokud spolu mají komunikovat a nejsou oddělené opticky musí být spojené se zemí</p>
<p>označuje se DQ (většinou začíná na D)</p>
<br>
<p>Vysvětlete princip přenosu dat po sběrnici One Wire</p>
<p>sériová komunikace asynchronní, typu master-slave, vždy komunikaci musí začít master,</p>
<p>master odešle původní sekvenci tak aby slave poznal koho oslovuje a nasledně slave podle adresy, kterou master uvedl</p>
<p>odpovi pomocí odpoví několika bitů</p>
<br>
<p>nakreslit standardní připojení one wire</p>
<p>https://scienceprog.com/understanding-1-wire-interface/</p>
<br>
<p>Kolik zařízení může být připojeno k jedné sběrnici One Wire.</p>
<p>Více zařízení, není to omezeno množstvím, ale kapacitou jako jednotkou, čím vyšší je kapacita,</p>
<p>tím při vyšší frekvenci dochází k útlumu těch přenášených dat a kvuli tomu by se to nemuselo dostat ke všem zařízením</p>
<br>
<p>Jakým způsobem určím, se kterým zařízením na One Wire se bude komunikovat? Uvedte priklad adresy zarizeni</p>
<p>kdyz se vyrabi one wire zarizeni, tak vzdy od vyroby je do zarizení zakomponovana jeho adresa, </p>
<p>a také podle prvních dvou hexadecimálních znaků lze poznat o jaký typ zařízení se jedná</p>
<p>Adresa: 10-25AFCD04050607</p>
<br>
<p>Jak se ověří, že data přijatá po 1-wire sběrnici jsou uplná a správná?</p>
<p>na konci kazde zpravy kterou odesila slave masterovi je tam CRC = kontrolní součet</p>
<br>
<p>Sběrnice I2C ---------------------------------------------------------------------------------------------------------------</p>
<br>
<p>(Master-slave, každé zařízení musí mít adresa, adresa je jeden byte, z toho jednoho bytu, se ten nejvyšší</p>
<p>bit se používá na to, že se určuje jestli chce master číst nebo zapisovat a tím pádem zůstava jen 7 bitů = 127 zařízení,</p> 
<p>synchronní = musí tam být signál CLOCK, standard přenosové rychlosti je 100kHz)</p>
<br>
<p>Kolik vodičů je potřeba pro přenos dat po sběrnici I2C a které to jsou?</p>
<p>2, CLOCK a DATA(obousměrný)</p>
<br>
<p>Vysvětlete princip přenosu dat po sběrnici I2C</p>
<p>podobné jak u One wire, ale je to řízené hodinovym signalem, prenasi se data na hranu hodinoveho signalu</p>
<br>
<p>Kolik zařízení může být připojeno k jedné sběrnici I2C v základní nerozšířené verzi?</p>
<p>127</p>
<br>
<p>Jaký význam mají Pull Up rezistory u I2C sběrnice? </p>
<p>rezistory ktere definuji defaultni uroven v dobe kdy neni nic pripojeneho, pull up = 1, pull down = 0,</p>
<p>tri stavy logickych obvodu = 1/0/nic(stav vysoke impedance)</p>
<br>
<p>Nakreslete zapojení, ve kterém připojíte 5 sériových I2C eeprom paměti 24LC256 k jedné sběrnici</p>
<br>
<p>Sběrnice SPI(synchronní komunikace)-------------------------------------------------------------------------------------------</p>
<br>
<p>Kolik vodičů je potřeba pro přenos dat po sběrnici SPI a které to jsou?</p>
<p>6, 2 napajeci, CLOCK, MISO, MOSI, chip select - slouzi k vybirani chipu/cidlo, se kterym chce komunikovat</p>
<br>
<p>Vysvětlete princip přenosu dat po sběrnici SPI</p>
<p>podobne jak u I2C, ale jsou tam 2 vodice misto jednoho pro prenos dat, kazdy z vodicu je vzdy vstupni nebo vystupni, </p>
<p>tzn. jednosmerne vodice, casto se kvuli tomu tahle sbernice pouziva, sice je tam jeden vodic navic, ale jsou vyrobne jednoducha</p>
<br>
<p>Jaka je zakladni prenosova rychlost sbernice SPI v porovnani s sbernici I2C</p>
<p>Je podstatne vyssi, rychlosti se pohybuji v radech Mb, az 70Mb, u I2C v radech kHz</p>
<br>
<p>Jake jsou nevyhody sbernice SPI</p>
<p>komunikacni vzdalenosti jsou kratsi nez u I2C a je tam neporadek u znaceni slave zarizeni</p>
<br>
<h2>IoT</h2>
<p>Internet of Things, Internet Věcí</p>
<br>
<p>Popiste vlastnosti zarizeni IoT</p>
<p>meli by byt pripojeny k internetu</p>
<p>mala zarizeni</p>
<p>prenasi po siti pouze velmi maly objem dat radove desitky bytu</p>
<p>maji nizkou spotrebu</p>
<br>
<p>Platformy pro IOT
<p>LoRaWAN, sigfox, IQRF - profesionalni platformy; ESP8266</p>
<br>
<p>Jake bezdratove frekvence se pouzivaji pro prenos dat pro IoT zarizeni, porovnejte vyhody nevyhody</p>
<p>2,4GHz;</p>
<p>866MHz - nejvice pouzivana, nizka spotreba, je regulovana, tzn. je nejmene zarusena (povoleno na teto frekvenci vysilat pouze 1% z doby provozu zarizeni), lze prenaset na velkou vzdalenost(1-2km);</p>
<p>433MHz;</p>
<p>cim nizsi je frekvence, tim lepe prochazi prekazkama, proto je 866 lepsi nez 2,4; </p>
<p>433 je docela zarusena frekvence, proto ji tolik profesionalni platformy nepouzivaji</p>
<br>
<p>Co je to MQTT?</p>
<p>komunikacni standard pro prenos zprav mezi IoT zarizenimi</p>
<p>nejznamejsi MQTT broker - MOSQUITTO</p>
  
  <h1>Přílohy</h1>
  <p><a href="HOSKO.zip" download>Soubory ke stažení</a></p>

</body>
</html>
